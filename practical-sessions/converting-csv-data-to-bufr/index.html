
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="WIS2 in a box (wis2box) is a Free and Open Source (FOSS) Reference Implementation of a WMO WIS2 Node. The project provides a plug and play toolset to ingest, process, and publish weather/climate/water data using standards-based approaches in alignment with the WIS2 principles. wis2box also provides access to all data in the WIS2 network. wis2box is designed to have a low barrier to entry for data providers, providing enabling infrastructure and services for data discovery, access, and visualization.">
      
      
        <meta name="author" content="World Meteorological Organization">
      
      
        <link rel="canonical" href="https://training.wis2box.wis.wmo.int/practical-sessions/converting-csv-data-to-bufr/">
      
      
        <link rel="prev" href="../converting-synop-data-to-bufr/">
      
      
        <link rel="next" href="../converting-daycli-data-to-bufr/">
      
      <link rel="icon" href="https://public.wmo.int/sites/all/themes/wmo/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15">
    
    
      
        <title>Converting CSV data to BUFR - WIS2 in a box training</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../../css/print-site.css">
    
      <link rel="stylesheet" href="../../css/print-site-material.css">
    
      <link rel="stylesheet" href="../../assets/css/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#converting-csv-data-to-bufr" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="WIS2 in a box training" class="md-header__button md-logo" aria-label="WIS2 in a box training" data-md-component="logo">
      
  <img src="../../assets/img/wmo-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WIS2 in a box training
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Converting CSV data to BUFR
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/wmo-im/wis2box-training" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="WIS2 in a box training" class="md-nav__button md-logo" aria-label="WIS2 in a box training" data-md-component="logo">
      
  <img src="../../assets/img/wmo-logo.png" alt="logo">

    </a>
    WIS2 in a box training
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/wmo-im/wis2box-training" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Practical sessions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Practical sessions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../connecting-to-mqtt/" class="md-nav__link">
        Connecting to WIS2 over MQTT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../accessing-your-student-vm/" class="md-nav__link">
        Accessing your student VM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../converting-synop-data-to-bufr/" class="md-nav__link">
        Converting SYNOP data to BUFR
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Converting CSV data to BUFR
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Converting CSV data to BUFR
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparation" class="md-nav__link">
    Preparation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#csv2bufr-primer" class="md-nav__link">
    csv2bufr primer
  </a>
  
    <nav class="md-nav" aria-label="csv2bufr primer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#necessary-csv-data" class="md-nav__link">
    Necessary CSV data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mappings-create" class="md-nav__link">
    mappings Create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-transform" class="md-nav__link">
    data transform
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eccodes-bufr-refresher" class="md-nav__link">
    ecCodes BUFR refresher
  </a>
  
    <nav class="md-nav" aria-label="ecCodes BUFR refresher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bufr_dump" class="md-nav__link">
    bufr_dump
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inspecting-csv-data-and-bufr-conversion" class="md-nav__link">
    Inspecting CSV data and BUFR conversion
  </a>
  
    <nav class="md-nav" aria-label="Inspecting CSV data and BUFR conversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exercise-1-converting-a-csv-file-to-bufr" class="md-nav__link">
    Exercise 1: Converting a CSV file to BUFR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-2-correcting-the-datetime-format" class="md-nav__link">
    Exercise 2: Correcting the datetime format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-3-handling-changes-to-the-csv-data" class="md-nav__link">
    Exercise 3: Handling changes to the CSV data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-4-unit-conversion" class="md-nav__link">
    Exercise 4: Unit conversion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-5-implementing-quality-control" class="md-nav__link">
    Exercise 5: Implementing quality control
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../converting-daycli-data-to-bufr/" class="md-nav__link">
        Converting DAYCLI data to BUFR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wis2box-introduction/" class="md-nav__link">
        wis2box introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data-ingest-and-monitoring/" class="md-nav__link">
        wis2box data ingest and monitoring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../downloading-and-finding-data-from-wis2/" class="md-nav__link">
        Downloading and finding data from WIS2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../environment-variables/" class="md-nav__link">
        wis2box environment variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../configuring-data-mappings/" class="md-nav__link">
        wis2box configuring data mappings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../configuring-wis2-discovery-metadata/" class="md-nav__link">
        wis2box configuring discovery metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../configuring-station-metadata/" class="md-nav__link">
        wis2box configuring station metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data-api-usage-and-queries/" class="md-nav__link">
        wis2box data API usage and queries
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_14" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_14" id="__nav_2_14_label" tabindex="0">
          Answers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_14_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_14">
          <span class="md-nav__icon md-icon"></span>
          Answers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../answers/synop2bufr-answers/" class="md-nav__link">
        SYNOP data to BUFR answers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../answers/csv2bufr-answers/" class="md-nav__link">
        CSV data to BUFR answers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Cheatsheets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Cheatsheets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/yaml/" class="md-nav__link">
        YAML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/wis2box/" class="md-nav__link">
        WIS2 in a box
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
            
          
        
          
            
          
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../schedule/namibia-2023-03/">Schedule</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Schedule
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../schedule/trinidad-and-tobago-2023-06/" class="md-nav__link">
        12 - 16 June 2023 - Port of Spain, Trinidad and Tobago 🇹🇹
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../schedule/indonesia-2023-10/" class="md-nav__link">
        9 - 13 October 2023 - Jakarta, Indonesia 🇮🇩
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparation" class="md-nav__link">
    Preparation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#csv2bufr-primer" class="md-nav__link">
    csv2bufr primer
  </a>
  
    <nav class="md-nav" aria-label="csv2bufr primer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#necessary-csv-data" class="md-nav__link">
    Necessary CSV data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mappings-create" class="md-nav__link">
    mappings Create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-transform" class="md-nav__link">
    data transform
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eccodes-bufr-refresher" class="md-nav__link">
    ecCodes BUFR refresher
  </a>
  
    <nav class="md-nav" aria-label="ecCodes BUFR refresher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bufr_dump" class="md-nav__link">
    bufr_dump
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inspecting-csv-data-and-bufr-conversion" class="md-nav__link">
    Inspecting CSV data and BUFR conversion
  </a>
  
    <nav class="md-nav" aria-label="Inspecting CSV data and BUFR conversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exercise-1-converting-a-csv-file-to-bufr" class="md-nav__link">
    Exercise 1: Converting a CSV file to BUFR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-2-correcting-the-datetime-format" class="md-nav__link">
    Exercise 2: Correcting the datetime format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-3-handling-changes-to-the-csv-data" class="md-nav__link">
    Exercise 3: Handling changes to the CSV data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-4-unit-conversion" class="md-nav__link">
    Exercise 4: Unit conversion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-5-implementing-quality-control" class="md-nav__link">
    Exercise 5: Implementing quality control
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="converting-csv-data-to-bufr">Converting CSV data to BUFR</h1>
<h2 id="introduction">Introduction</h2>
<p>CSV data is a commonly used format for recording tabular data.  <code>csv2bufr</code> is a tool to help
convert CSV to BUFR data.</p>
<p>In this session you will learn to create BUFR data from CSV, using custom and flexible
configuration (mappings) in support of meeting WMO GBON requirements.</p>
<h2 id="preparation">Preparation</h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Ensure that you are logged into your student VM.</p>
</div>
<p>Navigate to the <code>exercise-materials/csv2bufr-exercises</code> directory and make sure that the exercises directories are there.</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/exercise-materials/csv2bufr-exercises
ls
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You should be able to see the following directories <code>answers  ex_1  ex_2  ex_3  ex_4  ex_5</code></p>
</div>
<h2 id="csv2bufr-primer">csv2bufr primer</h2>
<h3 id="necessary-csv-data">Necessary CSV data</h3>
<p>There are some requirements on the data that must be present in the CSV file:</p>
<ul>
<li>WIGOS Station Identifier, either in 1 column or split over 4 columns for each component as follows:</li>
<li>Observation year</li>
<li>Observation month</li>
<li>Observation day</li>
<li>Observation hour</li>
<li>Observation minute</li>
<li>Latitude</li>
<li>Longitude</li>
<li>Station height</li>
<li>Barometer height</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notice that the datetime of the observation is split into 5 different columns (from most to least significant).</p>
</div>
<p>Below are essential <code>csv2bufr</code> commands and configurations:</p>
<h3 id="mappings-create">mappings Create</h3>
<p>The <code>mappings create</code> command creates an empty BUFR mapping template JSON file, which maps CSV column headers to their corresponding ecCodes element:</p>
<div class="highlight"><pre><span></span><code>csv2bufr<span class="w"> </span>mappings<span class="w"> </span>create<span class="w"> </span>&lt;BUFR<span class="w"> </span>descriptors&gt;<span class="w"> </span>--output<span class="w"> </span>&lt;my_template.json&gt;
</code></pre></div>
<p>For more information, see the following <a href="https://csv2bufr.readthedocs.io/en/latest/example.html#creating-a-new-mapping-file">example</a>.</p>
<h3 id="data-transform">data transform</h3>
<p>The <code>data transform</code> command converts a CSV file to BUFR format:</p>
<div class="highlight"><pre><span></span><code>csv2bufr<span class="w"> </span>data<span class="w"> </span>transform<span class="w"> </span>--bufr-template<span class="w"> </span>&lt;my_template.json&gt;<span class="w"> </span>--output-dir<span class="w"> </span>&lt;./my_directory&gt;<span class="w"> </span>&lt;my_data.csv&gt;
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The output directory is not required, and by default is the current working directory.</p>
</div>
<h2 id="eccodes-bufr-refresher">ecCodes BUFR refresher</h2>
<h3 id="bufr_dump">bufr_dump</h3>
<p>The <code>bufr_dump</code> function will allow you to inspect the BUFR files created from the conversion. It has numerous options, the following will be most applicable to the exercises:</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>&lt;my_bufr.bufr4&gt;
</code></pre></div>
<p>This will display the content of your BUFR on screen.  If you are interested in the values taken by a variable in particular, use the <code>egrep</code> command:</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>&lt;my_bufr.bufr4&gt;<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-i<span class="w"> </span>temperature
</code></pre></div>
<p>This will display the variables related to temperature in your BUFR data.  If you want to do this for multiple types of variables, filter the output using a pipe (<code>|</code>):</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>&lt;my_bufr.bufr4&gt;<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;temperature|wind&#39;</span>
</code></pre></div>
<h2 id="inspecting-csv-data-and-bufr-conversion">Inspecting CSV data and BUFR conversion</h2>
<h3 id="exercise-1-converting-a-csv-file-to-bufr">Exercise 1: Converting a CSV file to BUFR</h3>
<p>In this exercise we will look at a pre-configured mapping file for the CSV data, and will use this to convert the data to BUFR.</p>
<p>Navigate to the <code>ex_1</code> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/exercise-materials/csv2bufr-exercises/ex_1
</code></pre></div>
<p>and open the CSV data <code>ex_1.csv</code>.</p>
<ol>
<li>How many header rows are there in this data?</li>
<li>Which row contains the column names?</li>
</ol>
<p>Now open the mappings file <code>mappings_1.json</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>csv2bufr mappings files have no set file extension, however it recommended to use <code>.json</code>.</p>
</div>
<ol>
<li>
<p>Verify that <code>"number_header_rows"</code> and <code>"column_names_row"</code> are the same as your answers above.</p>
</li>
<li>
<p>Locate each of the CSV column names in this mappings file.</p>
</li>
<li>
<p>By the <code>data transform</code> command, use the mappings file to convert this CSV data to BUFR.</p>
</li>
<li>
<p>Use bufr_dump to find the latitude and longitude value stored in the output BUFR file. Verify these values using the CSV file.</p>
</li>
</ol>
<h3 id="exercise-2-correcting-the-datetime-format">Exercise 2: Correcting the datetime format</h3>
<p>In this exercise we will investigate the correct format to present the datetime of an observation in the CSV file.</p>
<p>Navigate to the <code>ex_2</code> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/exercise-materials/csv2bufr-exercises/ex_2
</code></pre></div>
<p>and open the CSV data <code>ex_2.csv</code>.</p>
<ol>
<li>What are the differences in the way that the datetime is represented in this CSV file compared to the previous one?</li>
</ol>
<p>Now open the mappings file <code>mappings_2.json</code>. By looking at the eccodes keys related to dates and times, it should seem clear that it is not possible to map the datetime with the CSV in its current state.</p>
<ol>
<li>
<p>Create new columns in the CSV file for each component of the datetime: <code>Year</code>, <code>Month</code>, <code>Day</code>, <code>Hour</code>, <code>Minute</code>.</p>
</li>
<li>
<p>By the <code>data transform</code> command, use the mappings file to convert this CSV data to BUFR.</p>
</li>
</ol>
<h3 id="exercise-3-handling-changes-to-the-csv-data">Exercise 3: Handling changes to the CSV data</h3>
<p>In this exercise we consider the following scenario: given the same CSV data but with different column names, how can we adjust the mappings file to convert this data to BUFR? For simplicity, we will only look at one column name change.</p>
<p>Navigate to the <code>ex_3</code> directory</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/exercise-materials/csv2bufr-exercises/ex_3
</code></pre></div>
<ol>
<li>By the <code>data transform</code> command, attempt to convert the CSV data to BUFR. What error appears?</li>
</ol>
<p>Open the CSV data <code>ex_3.csv</code>.</p>
<ol>
<li>What column name has been changed?</li>
</ol>
<p>Open the mappings file <code>mappings_3.json</code>.</p>
<ol>
<li>Find the original column name in this mapping file, and change it to the new name.</li>
<li>By the <code>data transform</code> command, use the mappings file to convert this CSV data to BUFR.</li>
<li>Use <code>bufr_dump</code> to verify that <code>relativeHumidity</code> has the same value as the CSV data.</li>
</ol>
<h3 id="exercise-4-unit-conversion">Exercise 4: Unit conversion</h3>
<p>In this exercise, we expand on the work above by not only handling changes to column names, but also the units of the data. We achieve this by using <code>offset</code> and <code>scale</code> in the mappings file.</p>
<p>Navigate to the <code>ex_4</code> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/exercise-materials/csv2bufr-exercises/ex_4
</code></pre></div>
<p>and open the CSV data <code>ex_4.csv</code>.</p>
<ol>
<li>Which row are the units of the variables written?</li>
</ol>
<p>You should notice that <code>BP</code> now has units hPa instead of Pa. Moreover, the air temperature and dewpoint temperature now have column names <code>AirTempC</code> and <code>DewPointTempC</code>, with units C instead of K.</p>
<ol>
<li>What power of 10 is needed to convert hPa to Pa?</li>
<li>What constant must be added to convert degrees C to K?</li>
</ol>
<p>Open the mappings file <code>mappings_4.json</code>. Find the lines corresponding to the variables above.</p>
<ol>
<li>
<p>Convert <code>BP</code> to Pa by adding the following line to the right of <code>"data:BP"</code>:</p>
<div class="highlight"><pre><span></span><code><span class="s2">&quot;offset&quot;</span>:<span class="w"> </span><span class="s2">&quot;const:0&quot;</span>,<span class="w"> </span><span class="s2">&quot;scale&quot;</span>:<span class="w"> </span><span class="s2">&quot;const:x&quot;</span>
</code></pre></div>
<p>where <code>x</code> is your answer in part 3.</p>
</li>
<li>
<p>Change the column names of air temperature and dewpoint temperature in the mappings file to match that of the CSV file, as you did in the previous exercise.</p>
</li>
<li>
<p>Convert <code>AirTempC</code> to K by adding the following line to the right of <code>"data:AirTempC"</code>:</p>
<div class="highlight"><pre><span></span><code><span class="s2">&quot;offset&quot;</span>:<span class="w"> </span><span class="s2">&quot;const:y&quot;</span>,<span class="w"> </span><span class="s2">&quot;scale&quot;</span>:<span class="w"> </span><span class="s2">&quot;const:0&quot;</span>
</code></pre></div>
<p>where <code>y</code> is your answer in part 4.</p>
</li>
<li>
<p>Convert <code>DewPointTempC</code> to K by adding the following line to the right of <code>"data:DewPointTempC"</code>:</p>
<div class="highlight"><pre><span></span><code><span class="s2">&quot;offset&quot;</span>:<span class="w"> </span><span class="s2">&quot;const:y&quot;</span>,<span class="w"> </span><span class="s2">&quot;scale&quot;</span>:<span class="w"> </span><span class="s2">&quot;const:0&quot;</span>
</code></pre></div>
<p>where <code>y</code> is your answer in part 4.</p>
</li>
<li>
<p>By running the <code>csv2bufr data transform</code> command, use the mappings file to convert this CSV data to BUFR.</p>
</li>
<li>
<p>Use the <code>bufr_dump</code> command to verify that <code>nonCoordinatePressure</code>, <code>airTemperature</code> and <code>dewpointTemperature</code> have the values you would expect after conversion.</p>
</li>
</ol>
<h3 id="exercise-5-implementing-quality-control">Exercise 5: Implementing quality control</h3>
<p>In this exercise, we will implement some minimum and maximum tolerable values to prevent data of certain variables from being encoded into BUFR. To do this, we will use <code>valid_min</code> and <code>valid_max</code> in the mappings file.</p>
<p>Navigate to the <code>ex_5</code> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/exercise-materials/csv2bufr-exercises/ex_5
</code></pre></div>
<ol>
<li>
<p>By running the <code>csv2bufr data transform</code> command, use the mappings file to convert this CSV data to BUFR. What error occurs? Is a BUFR file created?</p>
</li>
<li>
<p>Use the <code>bufr_dump</code> command to check the values of <code>pressureReducedToMeanSeaLevel</code>, <code>airTemperature</code> and <code>dewpointTemperature</code>. Which variables are missing, and why?</p>
</li>
</ol>
<p>Open the mappings file <code>mappings_5.json</code>. Find the lines corresponding to the variables above. You will find the following on these lines:</p>
<div class="highlight"><pre><span></span><code><span class="s2">&quot;valid_min&quot;</span>:<span class="w"> </span><span class="s2">&quot;const:a&quot;</span>,<span class="w"> </span><span class="s2">&quot;valid_max&quot;</span>:<span class="w"> </span><span class="s2">&quot;const:b&quot;</span>
</code></pre></div>
<p>where <code>a</code> and <code>b</code> are values. These values represent the minimum and maximum tolerable extremes for encoding into BUFR. </p>
<ol>
<li>
<p>Change <code>a</code> and <code>b</code> on each line to form a less tight range of tolerance for these variables.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>The valid minimum and maximum values should take the same units as the CSV data.</p>
</li>
<li>
<p>By running the <code>csv2bufr data transform</code> command, use this mappings file to convert this CSV data to BUFR again. Do you notice any errors this time?</p>
</li>
</ol>
<h2 id="conclusion">Conclusion</h2>
<div class="admonition success">
<p class="admonition-title">Congratulations!</p>
<p>In this practical session, you learned:</p>
<ul>
<li>The basic usage of <code>csv2bufr</code></li>
<li>The required structure of CSV data for conversion to BUFR</li>
<li>How to update a simple csv2bufr mapping file for a variety of scenarios, including for GBON requirements, unit conversion, and quality control/range checking</li>
<li>How to use <code>csv2bufr</code> on a test data file and convert to BUFR format</li>
<li>How to use <code>bufr_dump</code> to verify the values of BUFR encoded variables</li>
</ul>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2023 World Meteorological Organization
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.b4d07000.min.js"></script>
      
        <script src="../../js/print-site.js"></script>
      
    
  </body>
</html>